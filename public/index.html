<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Media File Manager - Upload and manage media files with metadata"
    />
    <script>
      // Comprehensive browser compatibility polyfills
      if (!Array.prototype.includes) {
        Array.prototype.includes = function(searchElement) {
          return this.indexOf(searchElement) !== -1;
        };
      }
      if (!Object.assign) {
        Object.assign = function(target) {
          for (var i = 1; i < arguments.length; i++) {
            var source = arguments[i];
            for (var key in source) {
              if (Object.prototype.hasOwnProperty.call(source, key)) {
                target[key] = source[key];
              }
            }
          }
          return target;
        };
      }
      if (!String.prototype.includes) {
        String.prototype.includes = function(search, start) {
          if (typeof start !== 'number') {
            start = 0;
          }
          if (start + search.length > this.length) {
            return false;
          } else {
            return this.indexOf(search, start) !== -1;
          }
        };
      }
      // Add fetch polyfill for older browsers
      if (!window.fetch) {
        window.fetch = function(url, options) {
          return new Promise(function(resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open(options && options.method || 'GET', url);
            xhr.onload = function() {
              resolve({
                ok: xhr.status >= 200 && xhr.status < 300,
                status: xhr.status,
                text: function() { return Promise.resolve(xhr.responseText); },
                json: function() { return Promise.resolve(JSON.parse(xhr.responseText)); }
              });
            };
            xhr.onerror = reject;
            if (options && options.body) {
              xhr.send(options.body);
            } else {
              xhr.send();
            }
          });
        };
      }
      if (!window.Promise) {
        window.Promise = function(executor) {
          var self = this;
          self.state = 'pending';
          self.value = undefined;
          self.handlers = [];
          
          function resolve(result) {
            if (self.state === 'pending') {
              self.state = 'fulfilled';
              self.value = result;
              self.handlers.forEach(handle);
              self.handlers = null;
            }
          }
          
          function reject(error) {
            if (self.state === 'pending') {
              self.state = 'rejected';
              self.value = error;
              self.handlers.forEach(handle);
              self.handlers = null;
            }
          }
          
          function handle(handler) {
            if (self.state === 'pending') {
              self.handlers.push(handler);
            } else {
              if (self.state === 'fulfilled' && typeof handler.onFulfilled === 'function') {
                handler.onFulfilled(self.value);
              }
              if (self.state === 'rejected' && typeof handler.onRejected === 'function') {
                handler.onRejected(self.value);
              }
            }
          }
          
          this.then = function(onFulfilled, onRejected) {
            return new Promise(function(resolve, reject) {
              handle({
                onFulfilled: function(result) {
                  try {
                    resolve(onFulfilled ? onFulfilled(result) : result);
                  } catch (ex) {
                    reject(ex);
                  }
                },
                onRejected: function(error) {
                  try {
                    resolve(onRejected ? onRejected(error) : error);
                  } catch (ex) {
                    reject(ex);
                  }
                }
              });
            });
          };
          
          try {
            executor(resolve, reject);
          } catch (ex) {
            reject(ex);
          }
        };
      }
      
      // Verify JavaScript bundle loading
      window.addEventListener('load', function() {
        console.log('Page loaded, checking for React...');
        setTimeout(function() {
          if (!window.React || !window.ReactDOM) {
            console.error('React libraries failed to load');
            document.getElementById('root').innerHTML = 
              '<div style="padding: 20px; color: red; background: #1a1a1a; font-family: Arial, sans-serif; min-height: 100vh;">' +
              '<h2>JavaScript Loading Error</h2>' +
              '<p>The React libraries failed to load. This could be due to:</p>' +
              '<ul>' +
              '<li>Network connectivity issues</li>' +
              '<li>Browser compatibility problems</li>' +
              '<li>Content blocking extensions</li>' +
              '</ul>' +
              '<p>Please try refreshing the page or using a different browser.</p>' +
              '</div>';
          }
        }, 2000);
      });
      
      // Add error event listener for script loading failures
      window.addEventListener('error', function(e) {
        if (e.target && e.target.tagName === 'SCRIPT') {
          console.error('Script loading failed:', e.target.src);
        }
      });
    </script>
    <title>Media File Manager</title>
  </head>
  <body>
    <noscript>
      <div style="padding: 20px; color: red; font-family: Arial, sans-serif; background: #1a1a1a; min-height: 100vh;">
        <h2>JavaScript Required</h2>
        <p>You need to enable JavaScript to run this app.</p>
      </div>
    </noscript>
    <div id="root">
      <div id="loading-indicator" style="padding: 20px; color: white; font-family: Arial, sans-serif; background: #1a1a1a; min-height: 100vh; display: flex; align-items: center; justify-content: center;">
        <div style="text-align: center;">
          <div style="border: 4px solid #333; border-top: 4px solid #4f46e5; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
          <h2>Loading Media File Manager...</h2>
          <p>Please wait while the application loads.</p>
          <p style="font-size: 12px; color: #888;">Please wait...</p>
        </div>
      </div>
    </div>
    <style>
      @keyframes spin { 
        0% { transform: rotate(0deg); } 
        100% { transform: rotate(360deg); } 
      }
    </style>
  </body>
</html>
